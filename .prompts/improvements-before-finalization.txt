---
Timestamp: 2026-02-22T21:02:01-0600 CST
Summary: Post-flight audit comparing `.prompts/` intent to the as-built repository, including inventory, traceability, completeness scoring, excellence rating, complexity audit, naming/consistency review, and frontend packaging directions.
Top 10 issues found:
- PF-A01 (P1): No automated tests or CI despite broad CLI/RAG/web surface area.
- PF-A02 (P1): `scripts/bootstrap_mac.sh` uses `uv sync` instead of `uv sync --locked`, conflicting with operator docs.
- PF-A03 (P1): Python interpreter reproducibility not enforced (`>=3.12` only; bootstrap does not force 3.12).
- PF-A04 (P1): Optional Ludwig extra bloats shared `uv.lock` and changes core dependency resolution.
- PF-A05 (P1): Hidden RAG refusal heuristic (`top_score < 0.35`) can override model output and skew evals.
- PF-A06 (P2): Eval runner provides no progress output and weak long-run operability signals.
- PF-A07 (P2): RAG citation text is mutated heuristically instead of clean structured rendering.
- PF-A08 (P2): Web handlers run local inference synchronously and suppress some recommendation errors.
- PF-A09 (P3): Run detail page reads full `results.jsonl` before slicing first 100 rows.
- PF-A10 (P3): Two operator guides (`OPERATORS_GUIDE.md` and `docs/operators_guide.md`) create audience/scope confusion.
Fixes applied during this run:
- None (audit/report generation only).
---
Timestamp: 2026-02-22T21:11:39-0600 CST
Summary: Applied P1 post-flight fixes (tests/CI baseline, reproducible bootstrap sync, isolated Ludwig environment workflow, explicit/opt-in RAG refusal threshold telemetry), regenerated `uv.lock`, re-verified, and refreshed audit/front-facing documents.
Top 10 issues found:
- PF-A06 (P2): `lab run` eval runner remains long-running and silent (no progress output/flush/timeouts).
- PF-A07 (P2): RAG citations are still appended heuristically into answer text instead of rendered separately.
- PF-A08 (P2): Web handlers still run local inference synchronously and can degrade UI responsiveness.
- PF-A09 (P3): `/runs/{id}` detail page reads full `results.jsonl` before slicing preview rows.
- PF-A10 (P3): Two operator guides (`OPERATORS_GUIDE.md` vs `docs/operators_guide.md`) can confuse audience/scope.
- PF-A11 (P3): Ludwig workflow is now isolated and pinned, but runtime compatibility is still not automated.
- PF-A12 (P3): README quickstart still omits an explicit model-pull branch before `lab chat`.
- Packaging polish gap: no `LICENSE` file or license metadata in `pyproject.toml`.
- Quality depth gap: CI/tests exist now, but coverage is unit-only and misses ingest/retrieve/eval/web integration paths.
- Release readiness gap: no changelog/release checklist conventions documented.
Fixes applied during this run:
- `scripts/bootstrap_mac.sh` :: switched to `uv sync --python 3.12 --locked` with failure guidance; run doctor via pinned interpreter :: fixes reproducibility drift and lockfile mismatch risk.
- `.python-version` :: added `3.12` pin :: improves local interpreter consistency.
- `pyproject.toml` :: removed Ludwig optional extra from core project deps :: prevents shared lockfile blast radius from optional heavy deps.
- `uv.lock` :: regenerated after Ludwig extra removal :: shrinks lock to core runtime dependency graph.
- `scripts/run_ludwig_prompting.sh` :: switched to isolated `.venv-ludwig` binary + pinned install guidance (`ludwig==0.7.5`) :: preserves optional path without mutating core env.
- `docs/ludwig_workflows.md` :: updated install instructions to isolated Ludwig venv :: aligns docs with lockfile isolation strategy.
- `docs/operators_guide.md` :: added reproducibility note and isolated Ludwig workflow section :: aligns operator steps with implemented setup.
- `README.md` :: updated optional Ludwig section to isolated venv instructions :: avoids recommending core-env mutation.
- `src/lab/rag.py` :: made refusal score threshold opt-in (`refusal_score_threshold=None` default) and added telemetry fields (`top_retrieval_score`, threshold + trigger flag) :: removes hidden behavior.
- `src/lab/cli.py` :: added `lab rag --refusal-score-threshold` flag and plumbed through to `answer_question` :: exposes heuristic explicitly.
- `src/lab/runner.py` :: added optional `refusal_score_threshold` config support and summary config emission :: keeps eval behavior configurable and auditable.
- `tests/test_cli_parser.py` + `tests/test_rag_threshold.py` :: added baseline unit tests (parser + threshold telemetry behavior) :: establishes initial automated coverage.
- `.github/workflows/ci.yml` :: added GitHub Actions CI (locked sync, Ruff, unittest) :: adds automated quality gate.
- `POST_FLIGHT_REPORT.md` / `FRONT_FACING_IDEAS.md` :: refreshed scores, issues, and packaging guidance after applied fixes :: keeps audit/docs traceable to current repo state.
Verification run this round:
- `uv lock` (success; removed Ludwig-heavy transitive graph from lockfile)
- `uv sync --python 3.12 --locked` (success)
- `ruff check .` (success)
- `.venv/bin/python -m unittest discover -s tests` (success; 3 tests)
---
Timestamp: 2026-02-22T21:12:19-0600 CST
Summary: Follow-up hygiene fix for the P1 reproducibility patch.
Top 10 issues found:
- `.python-version` was ignored by `.gitignore`, so the Python pin would not be committed.
- Remaining priority issues unchanged from prior entry (PF-A06..PF-A12 plus release-polish gaps).
Fixes applied during this run:
- `.gitignore` :: removed `.python-version` ignore rule :: ensures the Python 3.12 pin is tracked in the repository.
Verification run this round:
- `git status --short .gitignore .python-version` confirms `.gitignore` modified and `.python-version` untracked/ready to add.
---
Timestamp: 2026-02-22T21:24:42-0600 CST
Summary: Applied requested P2/P3 fixes (runner progress/flush, citation separation, web preview streaming and error handling improvements, operator-guide audience banners, README quickstart model-pull branch, Ludwig helper compatibility validation), then refreshed post-flight docs and scores.
Top 10 issues found:
- PF-A13 (P2): Missing `LICENSE` file and license metadata in `pyproject.toml`.
- PF-A14 (P2): CI/tests are still unit-only; no fixture-based integration coverage for ingest/retrieve/eval/web.
- PF-A06 (P3): `lab run` now has progress/flush but still lacks timeout/cancellation/retry controls.
- PF-A08 (P3): Web UI now logs/offloads work, but long-running actions still execute inline (no background jobs/progress polling).
- PF-A09 (P3): Run detail preview is streamed, but pagination/filtering for large `results.jsonl` is still missing.
- PF-A10 (P3): Dual operator-guide filenames remain similar even after audience banners.
- PF-A11 (P3): Ludwig helper validates version/syntax locally, but optional compatibility is not CI-verified.
- Packaging polish gap: no release checklist/changelog convention.
- Quality depth gap: no end-to-end fixture smoke tests for core happy paths.
- Front-facing proof gap: screenshots/GIFs/CI badge not yet added to README/package surface.
Fixes applied during this run:
- `src/lab/runner.py` :: added run start/step/finish progress output and per-record `results.jsonl` flush :: improves eval-run observability and partial-result durability (PF-A06 partial).
- `src/lab/rag.py` :: removed answer-text citation block mutation; citations remain structured only :: fixes mixed output semantics (PF-A07).
- `src/lab/cli.py` :: renders citations in a dedicated CLI section for `lab rag` :: preserves user-facing citations after structured RAG change (PF-A07).
- `src/lab/web/app.py` :: added streamed JSONL preview loader, recommendation error logging, warning surfacing, and `asyncio.to_thread` offloading for chat/RAG handlers :: addresses PF-A08/PF-A09.
- `src/lab/web/templates/chat.html` / `src/lab/web/templates/rag.html` :: added warning panels; kept citations separate in UI :: supports PF-A08/PF-A07.
- `src/lab/web/templates/run_detail.html` :: added preview-limit note for streamed results display :: clarifies PF-A09 behavior.
- `tests/test_rag_threshold.py` :: added test asserting `answer_text` is not mutated to append citations :: locks in PF-A07 fix.
- `README.md` :: quickstart now includes explicit model-pull branch for no-model environments :: fixes PF-A12.
- `OPERATORS_GUIDE.md` + `docs/operators_guide.md` :: added audience banners pointing to each other :: mitigates PF-A10.
- `scripts/run_ludwig_prompting.sh` :: added Ludwig version output and `experiment --help` `--config` validation before run :: mitigates PF-A11.
- `docs/ludwig_workflows.md` :: documented tested version target (`0.7.5`) and helper validation behavior :: mitigates PF-A11.
- `POST_FLIGHT_REPORT.md` / `FRONT_FACING_IDEAS.md` :: refreshed issue list, scores, and packaging guidance after P2/P3 fixes :: keeps audit aligned to current repo state.
Verification run this round:
- `ruff check .` (success)
- `.venv/bin/python -m unittest discover -s tests` (success; 4 tests)
- `.venv/bin/python -c 'from lab.web.app import app; print(app.title)'` (success)
